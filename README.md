# 基于多源信息融合的驾驶员分神状态识别及风险预警系统

## 项目介绍

### 项目背景

随着交通工具的普及和交通环境的复杂化，驾驶过程中的分心行为成为交通事故的重要诱因。为了提高驾驶安全性，我们开发了一款智能驾驶人分神检测与预警系统，旨在及时识别驾驶人的分神行为，并通过预警措施降低交通事故的发生率。

### 项目功能

本项目主要包含以下几个模块

1、数据采集模块

* 基于matlab二次开发的Shimmer生理反馈仪获取驾驶人的心电、皮电、呼吸频率等六个生理指标

* 基于retinaface人脸检测框架获取驾驶人的眼部凝视角（R_angle），头部偏航（yaw）、俯仰（pitch）、翻滚（roll）角等三个指标

* 基于驾驶模拟器来获取到转向盘回转率(SRR)、横向位置标准差(SDLP)、车头转角标准差(SDHA)、转向盘转角标准差(SDSA)、转向熵(TradSE)、转向盘旋转率(SteerigVelocity)的均值及标准差等车辆横向操纵指标和车辆行驶速度(Speed)、加速度(acceleration)、加速踏板(throttle)及制动踏板(brake)输入值等特征的均值和标准差构成的车辆纵向指标，两类车辆运动指标共计15个。

2、实时数据的存储和使用

* 基于MySQL数据库实时存储和获取最新的驾驶数据，确保系统能够及时响应并处理。

3、模型判断

* 通过训练好的BP神经网络分神状态识别算法，将数据采集模块获取到的数据实时的从数据库读出输入模型，输出分神的状态

4、分神预警

* 若系统检测到驾驶人存在分神行为，则通过声音播报进行及时警示，提醒驾驶人重新集中注意力。

## Configuration Environment

**考虑到生理数据采集以及驾驶绩效数据的采集需要配备相关的硬件，本项目仅开源视线朝向、头部姿态估计与实时显示的部分**

**Requirements**

* python 3.5+
* mxnet 1.7.0 
* tensorflow 2.4.0

* 下载 .gitignore文件

## Run

* 准备一个单目摄像头
* python project.py

## Involving content

* 人脸检测

	```
	论文：https://arxiv.org/abs/1905.00641
	项目代码：https://github.com/1996scarlet/faster-mobile-retinaface
	```

* 人脸关键点检测

	```
	默认使用的是MobileNet-v2 version（1.4M）
	可选的其他版本https://github.com/deepinx/deep-face-alignment【37M】
	```

* 头部姿态估计

	```
	https://github.com/lincolnhard/head-pose-estimation
	使用 dlib和 OpenCV实现头部姿态的估计
	```

* 虹膜分割

    ```
    论文：https://ieeexplore.ieee.org/document/8818661
    本文提出了一种基于单目RGB相机的实时精确的三维眼球注视跟踪方法。我们的关键思想是训	  练一个深度卷积神经网络(DCNN)，自动从输入图像中提取每只眼睛的虹膜和瞳孔像素。为了     实现这一目标，我们结合Unet[1]和Squeezenet[2]的能力来训练一个高效的卷积神经网络     进行像素分类。此外，我们在最大后验框架中跟踪三维眼睛注视状态，该框架在每一帧中顺序     搜索最可能的三维眼睛注视状态。当眼睛眨眼时，眼球注视跟踪器会得到不准确的结果。为了     提高眼睛注视跟踪器的鲁棒性和准确性，我们进一步扩展了卷积神经网络用于眼睛的近距离检     测。我们的系统在台式电脑和智能手机上实时运行。我们已经在直播视频和网络视频上评估了     我们的系统，我们的结果表明，该系统对于不同性别、种族、光照条件、姿势、形状和面部表     情都是稳健和准确的。与Wang等人[3]的对比表明，我们的方法在使用单一RGB摄像头的3D眼     球跟踪方面取得了先进水平。
    ```

## 运行效果展示












